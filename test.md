# MarkFlow — AI 기반 로컬 퍼스트 블로깅 플랫폼

> **Product Requirements Document & Task Breakdown**
> Version 1.0 | 2026.02 | 작성: Lee

---

## 1. 제품 개요

### 1.1 비전

마크다운의 간결함, AI의 지능, 원클릭 배포의 편리함을 결합한 데스크톱 네이티브 블로깅 도구. 기존 노션/워드프레스가 해결하지 못한 **'개인화된 전문 퍼블리싱'**을 로컬 퍼스트 아키텍처로 실현한다.

### 1.2 핵심 가치 제안

- **로컬 퍼스트**: 오프라인 완전 동작, `.md` 파일 기반 데이터 주권 보장
- **AI 편집 파트너**: 맥락 인식 교정, SEO 체크리스트, 스타일 가이드 학습
- **원클릭 배포**: Git 기반 CD 파이프라인으로 Vercel/Netlify 자동 배포
- **디자인 자유도**: 디자인 토큰 + 눈누 폰트로 완전한 레이아웃 커스터마이징

### 1.3 타겟 사용자

- **1차**: 기술 블로거 및 개발자 (마크다운에 익숙, 자동화 선호)
- **2차**: 전문 콘텐츠 크리에이터 (브랜딩과 SEO에 민감)
- **3차**: 지식 노동자 (노션에서 이탈 고려 중인 사용자)

### 1.4 기술 스택 요약

| 구분 | 기술 |
|------|------|
| 프레임워크 | Electron + React (Vite) |
| 에디터 코어 | CodeMirror 6 (마크다운 모드) |
| 스타일링 | Tailwind CSS + CSS Variables (디자인 토큰) |
| 로컬 DB | SQLite (better-sqlite3) + .md 파일 시스템 |
| AI 연동 | OpenAI / Claude API (어댑터 패턴) |
| 배포 파이프라인 | isomorphic-git + Vercel/Netlify CLI |
| SSG 엔진 | Astro 또는 Next.js (static export) |
| 패키지 관리 | pnpm + Turborepo 모노레포 |

### 1.5 경쟁 제품 대비 포지셔닝

| 비교 항목 | Notion | Ghost | WordPress | Framer | **MarkFlow** |
|-----------|--------|-------|-----------|--------|-------------|
| 오프라인 지원 | △ | ✕ | ✕ | ✕ | **✔** |
| 마크다운 네이티브 | ✕ | △ | △ | ✕ | **✔** |
| AI 편집 보조 | △ | ✕ | 플러그인 | ✕ | **✔** |
| 디자인 커스터마이징 | △ | △ | ✔ | ✔ | **✔** |
| 원클릭 배포 | ✕ | ✔ | ✕ | ✔ | **✔** |
| 한국어 폰트 생태계 | ✕ | ✕ | 플러그인 | ✕ | **✔** |
| 데이터 주권 | ✕ | △ | ✔ | ✕ | **✔** |

---

## 2. 기능 명세

### Phase 1: MVP Core Editor — 8주

핵심 에디팅 경험과 로컬 파일 관리에 집중. AI 없이도 독립적으로 사용 가능한 마크다운 에디터를 완성한다.

| ID | 기능 | 상세 | 우선순위 |
|----|------|------|----------|
| F-01 | 마크다운 에디터 | CodeMirror 6 기반, 문법 하이라이팅, 자동 완성, 단축키 지원 | P0 |
| F-02 | 실시간 미리보기 | Split-pane 레이아웃, 스크롤 동기화, 라이브 렌더링 | P0 |
| F-03 | 파일 탐색기 | 로컬 .md 파일 트리 뷰, 드래그앤드롭, 검색 | P0 |
| F-04 | 프론트매터 편집기 | YAML 프론트매터 GUI (제목, 태그, 카테고리, 날짜) | P0 |
| F-05 | 이미지 삽입 | 드래그앤드롭 이미지 삽입, 로컬 저장, 상대경로 자동 생성 | P1 |
| F-06 | 테마 기본 | 라이트/다크 모드 전환, 기본 타이포그래피 설정 | P1 |
| F-07 | 자동 저장 | 디바운스 기반 자동 저장, 변경 감지 인디케이터 | P0 |
| F-08 | 단축키 시스템 | 커스터마이저블 키바인딩 (VS Code 스타일) | P1 |

### Phase 2: AI & Design System — 6주

AI 편집 보조와 디자인 토큰 시스템을 도입하여 핵심 차별점을 확립한다.

| ID | 기능 | 상세 | 우선순위 |
|----|------|------|----------|
| F-09 | AI 대화창 | Split-pane 우측에 AI 채팅 인터페이스, 컨텍스트 전달 | P0 |
| F-10 | AI 텍스트 교정 | 선택 영역 맥락 기반 문법/비문 교정, 인라인 제안 | P0 |
| F-11 | AI SEO 체크리스트 | 제목 매력도, 메타 설명, Alt 텍스트, 태그 추천 자동 점검 | P1 |
| F-12 | 디자인 토큰 엔진 | 참조/시스템/컴포넌트 3계층 토큰, JSON 기반 관리 | P0 |
| F-13 | 테마 에디터 GUI | 비주얼 토큰 편집기, 실시간 CSS 변수 컴파일, 미리보기 반영 | P1 |
| F-14 | 눈누 폰트 통합 | API/CDN 연동, 폰트 브라우저, @font-face 동적 등록 | P1 |
| F-15 | 이미지 자동 최적화 | WebP/AVIF 변환, 리사이즈, EXIF 제거, `<picture>` 태그 생성 | P1 |

### Phase 3: 배포 & 버전 관리 — 6주

원클릭 배포 파이프라인과 비개발자 친화적 버전 관리 시스템을 구축한다.

| ID | 기능 | 상세 | 우선순위 |
|----|------|------|----------|
| F-16 | Git 통합 | isomorphic-git으로 커밋/푸시, GitHub 연동, SSH 키 관리 | P0 |
| F-17 | 원클릭 배포 | Vercel/Netlify CLI 연동, 빌드 트리거, 배포 상태 알림 | P0 |
| F-18 | SSG 빌드 | Astro 기반 정적 사이트 생성, 마크다운→HTML 변환 | P0 |
| F-19 | 비주얼 버전 관리 | 타임라인 UI, diff 뷰어, 체크포인트 저장/복원 | P1 |
| F-20 | 자동 백업 | 주기적 로컬 스냅샷, 배포 이력과 로컬 초안 동기화 표시 | P1 |
| F-21 | 커스텀 도메인 | 사용자 도메인 연결 가이드, DNS 설정 도우미 | P2 |

### Phase 4: 고도화 — 6주+

멀티 워크스페이스, 수익화, AEO 등 확장 기능으로 제품 경쟁력을 극대화한다.

| ID | 기능 | 상세 | 우선순위 |
|----|------|------|----------|
| F-22 | AI 스타일 학습 | 사용자 과거 글 분석, 개인 브랜드 보이스 유지 | P1 |
| F-23 | AEO 최적화 | FAQ 블록 자동 생성, Schema Markup 자동 삽입 | P1 |
| F-24 | 멀티 워크스페이스 | 블로그별 독립 토큰 세트/AI 프로필, 프로젝트 전환 | P2 |
| F-25 | 수익화 도구 | 유료 구독 폼, 멤버십 콘텐츠 게이팅, 결제 연동 | P2 |
| F-26 | 웹 버전 준비 | 모노레포 분리, 어댑터 패턴 데이터 계층, IndexedDB 지원 | P2 |
| F-27 | 표절/AI 탐지 | 기존 문서 유사도 체크, AI 생성물 비율 분석 | P2 |

---

## 3. 아키텍처 설계

### 3.1 모노레포 구조

```
markflow/
├── apps/
│   ├── desktop/          # Electron 메인/렌더러 (Vite + React)
│   └── web/              # (Phase 4) 웹 앱 셸
├── packages/
│   ├── editor-core/      # CodeMirror 6 에디터 래퍼, 마크다운 파싱
│   ├── ui/               # 공유 UI 컴포넌트 라이브러리
│   ├── design-tokens/    # 토큰 정의, CSS 변수 컴파일러 (Style Dictionary)
│   ├── ai-client/        # AI API 어댑터 (OpenAI/Claude 교체 가능)
│   └── deploy/           # Git 연동, SSG 빌드, 호스팅 CLI 래퍼
├── turbo.json
├── pnpm-workspace.yaml
└── package.json
```

### 3.2 Electron 보안 체크리스트

- **contextIsolation: true** — 렌더러에서 Node.js 직접 접근 차단
- **nodeIntegration: false** — 웹 콘텐츠의 시스템 접근 방지
- **preload 스크립트** — `contextBridge.exposeInMainWorld`로 최소 API만 노출
- **CSP 헤더 설정** — 인라인 스크립트 차단, 허용 도메인 화이트리스트
- **BrowserView 사용** — 외부 콘텐츠 렌더링 시 프로세스 격리

### 3.3 데이터 흐름

```
사용자 편집
  → CodeMirror 상태
  → .md 파일 저장 (로컬)
  → SQLite 메타데이터 인덱싱
  → Git 커밋
  → 배포 트리거
  → Astro SSG 빌드
  → CDN 배포 (Vercel/Netlify)
```

모든 원본 데이터는 로컬 `.md` 파일에 존재하며, SQLite는 검색/필터용 인덱스 역할만 수행한다.

### 3.4 디자인 토큰 계층

```json
{
  "ref": {
    "color": { "blue-500": "#007bff", "gray-100": "#f8f9fa" }
  },
  "sys": {
    "color": { "primary": "{ref.color.blue-500}", "surface": "{ref.color.gray-100}" }
  },
  "comp": {
    "sidebar": { "bg": "{sys.color.surface}" },
    "editor": { "text": "{sys.color.on-surface}" }
  }
}
```

사용자가 GUI에서 토큰 값을 수정하면 실시간으로 CSS 변수(`--primary-color` 등)로 컴파일되어 미리보기에 반영된다.

---

## 4. 작업 리스트 (Task Breakdown)

1인 개발 기준이며, 병렬 작업이 어려운 의존 관계를 고려했다.

### Phase 1: MVP Core Editor (8주, 40 영업일)

| # | 태스크 | 설명 | 일수 |
|---|--------|------|------|
| 1 | 프로젝트 초기 세팅 | Turborepo + pnpm 모노레포 구성, ESLint/Prettier, CI 기본 셋업 | 2 |
| 2 | Electron 앱 스캐폴딩 | Vite + React + Electron 통합, 보안 설정 (preload, CSP), 핫리로드 | 3 |
| 3 | CodeMirror 에디터 통합 | 마크다운 모드, 문법 하이라이팅, 기본 단축키, 에디터 상태 관리 | 5 |
| 4 | 마크다운 파서 연동 | remark/rehype 파이프라인, GFM 지원, 코드 블록 하이라이팅 | 3 |
| 5 | Split-pane 레이아웃 | 에디터/미리보기 분할 화면, 리사이즈, 스크롤 싱크 | 3 |
| 6 | 파일 시스템 연동 | Node.js fs로 .md CRUD, 파일 와처(chokidar), 자동 저장 | 4 |
| 7 | 파일 탐색기 UI | 트리뷰 컴포넌트, 디렉토리 재귀 탐색, 파일 검색 | 4 |
| 8 | 프론트매터 편집기 | YAML 파싱(gray-matter), GUI 폼, 에디터 동기화 | 3 |
| 9 | 이미지 드래그앤드롭 | 파일 드롭 핸들러, 로컬 assets 폴더 저장, 상대경로 삽입 | 3 |
| 10 | 기본 테마 시스템 | CSS 변수 기반 라이트/다크 모드, 폰트 사이즈 설정 | 2 |
| 11 | 키바인딩 시스템 | 커스터마이저블 단축키 매니저, 설정 저장/로드 | 3 |
| 12 | SQLite 메타데이터 | better-sqlite3 연동, 게시물 인덱싱, 태그/카테고리 검색 | 3 |
| 13 | Phase 1 QA & 버그픽스 | 통합 테스트, E2E 테스트(Playwright), 성능 프로파일링 | 2 |

### Phase 2: AI & Design System (6주, 30 영업일)

| # | 태스크 | 설명 | 일수 |
|---|--------|------|------|
| 14 | AI 클라이언트 어댑터 | OpenAI/Claude API 추상화, 스트리밍 응답, 에러 핸들링, 토큰 카운팅 | 3 |
| 15 | AI 대화창 UI | 채팅 인터페이스, 메시지 히스토리, 마크다운 렌더링, 컨텍스트 주입 | 4 |
| 16 | 인라인 AI 교정 | 텍스트 선택 → AI 호출 → diff 표시 → 승인/거부 UX | 5 |
| 17 | AI SEO 체크리스트 | 제목 분석, 메타 설명 생성, Alt 텍스트 검사, 태그 추천 로직 | 4 |
| 18 | 디자인 토큰 엔진 | JSON 토큰 스키마, 3계층 파싱, CSS 변수 컴파일러 (Style Dictionary) | 4 |
| 19 | 테마 에디터 GUI | 색상 피커, 타이포그래피 셀렉터, 간격 조절, 실시간 미리보기 반영 | 4 |
| 20 | 눈누 폰트 통합 | CDN/로컬 폰트 로더, 폰트 브라우저 UI, @font-face 동적 등록 | 3 |
| 21 | 이미지 최적화 파이프라인 | sharp 기반 WebP/AVIF 변환, 리사이즈, EXIF 제거, `<picture>` 생성 | 3 |
| 22 | Phase 2 QA & 통합 | AI 응답 품질 테스트, 토큰 시스템 엣지케이스, 폰트 라이선스 검증 | 2 |

### Phase 3: 배포 & 버전 관리 (6주, 30 영업일)

| # | 태스크 | 설명 | 일수 |
|---|--------|------|------|
| 23 | isomorphic-git 연동 | Git init/add/commit/push, GitHub OAuth, SSH 키 생성/관리 | 4 |
| 24 | Astro SSG 통합 | 마크다운→HTML 빌드, 디자인 토큰 적용, 레이아웃 템플릿 | 5 |
| 25 | 배포 파이프라인 | Vercel/Netlify CLI 래퍼, 빌드→배포 자동화, 상태 모니터링 | 4 |
| 26 | 원클릭 배포 UI | 배포 버튼, 진행 상황 표시, 배포 URL 링크, 에러 핸들링 | 3 |
| 27 | 비주얼 타임라인 | Git 히스토리 시각화, 커밋 메시지 자동 생성, 체크포인트 UI | 4 |
| 28 | Diff 뷰어 | 이전/현재 버전 비교, 라인 단위 하이라이팅, 롤백 기능 | 3 |
| 29 | 자동 백업 시스템 | 주기적 스냅샷, 배포 버전 vs 로컬 초안 동기화 상태 표시 | 3 |
| 30 | 커스텀 도메인 가이드 | DNS 설정 안내 UI, Vercel/Netlify 도메인 API 연동 | 2 |
| 31 | Phase 3 QA & 통합 | 배포 E2E 테스트, Git 충돌 시나리오, 롤백 검증 | 2 |

### Phase 4: 고도화 (6주+)

| # | 태스크 | 설명 | 일수 |
|---|--------|------|------|
| 32 | AI 스타일 학습 | 사용자 글 임베딩, 스타일 프로필 생성, 교정 시 스타일 반영 | 5 |
| 33 | AEO 엔진 | FAQ 블록 자동 추출, JSON-LD Schema Markup 생성기 | 4 |
| 34 | 멀티 워크스페이스 | 워크스페이스 매니저, 독립 토큰/AI 프로필 전환 | 4 |
| 35 | 수익화 도구 | 구독 폼 컴포넌트, 콘텐츠 게이팅 로직, Stripe 연동 | 5 |
| 36 | 웹 버전 데이터 계층 | 어댑터 패턴 구현, IndexedDB/Cloud API 스위칭, CRDT 검토 | 5 |
| 37 | 표절/AI 탐지 | 텍스트 유사도 API 연동, AI 생성 비율 분석 UI | 3 |
| 38 | 성능 최적화 | 번들 분석, 코드 스플리팅, 메모리 프로파일링, 콜드 스타트 개선 | 4 |

---

## 5. 마일스톤 & 일정

| 마일스톤 | 목표 | 완료 기준 | 예상 시점 |
|----------|------|-----------|-----------|
| **M1: Alpha** | 마크다운 에디팅 코어 완성 | .md 파일 읽기/쓰기/미리보기가 안정적으로 동작 | Week 8 |
| **M2: Beta** | AI 편집 + 디자인 시스템 | AI 교정/SEO 체크 동작, 디자인 토큰으로 테마 변경 가능 | Week 14 |
| **M3: RC** | 배포 파이프라인 완성 | 원클릭으로 정적 사이트 빌드 + 배포 성공 | Week 20 |
| **M4: v1.0** | 공개 릴리스 | 고도화 기능 포함, 공개 베타 피드백 반영 완료 | Week 26+ |

---

## 6. 리스크 & 대응

| 리스크 | 영향 | 대응 방안 |
|--------|------|-----------|
| Electron 번들 사이즈 (100MB+) | 높음 | electron-builder 최적화, 불필요 로케일 제거, ASAR 압축 |
| AI API 비용 증가 | 중간 | 로컬 LLM 대안 (Ollama) 어댑터 준비, 토큰 사용량 대시보드 |
| 눈누 폰트 라이선스 이슈 | 중간 | 폰트별 라이선스 메타데이터 DB 구축, 사용자에게 명시적 안내 |
| 1인 개발 병목 | 높음 | Phase 1 MVP에 집중, Phase 4는 사용자 피드백 기반 우선순위 조정 |
| SSG 빌드 호환성 | 낮음 | Astro의 마크다운 지원이 가장 안정적, 폴백으로 Next.js static |

---

## 7. 성공 지표

- **MVP 완성도**: Phase 1 완료 후 자체 블로그를 본 도구로 운영 가능한가
- **배포 성공률**: 원클릭 배포 성공률 95% 이상
- **에디터 반응 속도**: 키 입력 → 미리보기 반영 100ms 이내
- **AI 교정 품질**: 맞춤법 교정 정확도 90% 이상, SEO 체크리스트 커버리지 80%
- **콜드 스타트**: 앱 실행 → 에디터 사용 가능 3초 이내
- **사용자 피드백**: 공개 베타 후 GitHub Star 100개, 주간 활성 사용자 50명 (3개월 내)